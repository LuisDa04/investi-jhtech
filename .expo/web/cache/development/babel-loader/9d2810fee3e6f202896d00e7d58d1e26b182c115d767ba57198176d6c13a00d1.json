{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\invit\\\\Downloads\\\\investi-app\\\\src\\\\contexts\\\\AuthContext.tsx\";\nimport React, { createContext, useContext, useEffect, useState } from 'react';\nimport * as SecureStore from 'expo-secure-store';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst AuthContext = createContext({});\nexport const AuthProvider = ({\n  children\n}) => {\n  const [isAuthenticated, setIsAuthenticated] = useState(false);\n  const [isLoading, setIsLoading] = useState(true);\n  const [user, setUser] = useState(null);\n  useEffect(() => {\n    checkAuthState();\n  }, []);\n  const checkAuthState = async () => {\n    try {\n      const token = await SecureStore.getItemAsync('access_token');\n      setIsAuthenticated(!!token);\n    } catch (error) {\n      console.error('Error checking auth state:', error);\n      setIsAuthenticated(false);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n  const signIn = async (token, refreshToken, userData) => {\n    try {\n      await SecureStore.setItemAsync('access_token', token);\n      if (refreshToken) {\n        await SecureStore.setItemAsync('refresh_token', refreshToken);\n      }\n      setUser(userData);\n      setIsAuthenticated(true);\n      navigation.navigate('HomeFeed');\n    } catch (error) {\n      console.error('Error signing in:', error);\n      throw error;\n    }\n  };\n  const updateUser = userData => {\n    if (user) {\n      setUser(Object.assign({}, user, userData));\n    }\n  };\n  const signOut = async () => {\n    try {\n      await SecureStore.deleteItemAsync('access_token');\n      await SecureStore.deleteItemAsync('refresh_token');\n      setUser(null);\n      setIsAuthenticated(false);\n      navigation.navigate('Welcome');\n    } catch (error) {\n      console.error('Error signing out:', error);\n      throw error;\n    }\n  };\n  return _jsxDEV(AuthContext.Provider, {\n    value: {\n      isAuthenticated,\n      isLoading,\n      user,\n      signIn,\n      signOut,\n      updateUser\n    },\n    children: !isLoading && children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 84,\n    columnNumber: 5\n  }, this);\n};\nexport const useAuth = () => {\n  const context = useContext(AuthContext);\n  if (!context) {\n    throw new Error('useAuth must be used within an AuthProvider');\n  }\n  return context;\n};","map":{"version":3,"names":["React","createContext","useContext","useEffect","useState","SecureStore","jsxDEV","_jsxDEV","AuthContext","AuthProvider","children","isAuthenticated","setIsAuthenticated","isLoading","setIsLoading","user","setUser","checkAuthState","token","getItemAsync","error","console","signIn","refreshToken","userData","setItemAsync","navigation","navigate","updateUser","Object","assign","signOut","deleteItemAsync","Provider","value","fileName","_jsxFileName","lineNumber","columnNumber","useAuth","context","Error"],"sources":["C:/Users/invit/Downloads/investi-app/src/contexts/AuthContext.tsx"],"sourcesContent":["import React, { createContext, useContext, useEffect, useState } from 'react';\nimport * as SecureStore from 'expo-secure-store';\n\nexport type User = {\n  id: string;\n  email: string;\n  name?: string;\n  username?: string;\n  photo_url?: string;\n  created_at?: string;\n  updated_at?: string;\n  // Add other user properties as needed\n};\n\ntype AuthContextData = {\n  isAuthenticated: boolean;\n  isLoading: boolean;\n  user: User | null;\n  signIn: (token: string, refreshToken: string, user: User) => Promise<void>;\n  signOut: () => Promise<void>;\n  updateUser: (user: Partial<User>) => void;\n};\n\nconst AuthContext = createContext<AuthContextData>({} as AuthContextData);\n\nexport const AuthProvider: React.FC<{ children: React.ReactNode }> = ({ children }) => {\n  const [isAuthenticated, setIsAuthenticated] = useState(false);\n  const [isLoading, setIsLoading] = useState(true);\n  const [user, setUser] = useState<User | null>(null);\n\n  useEffect(() => {\n    checkAuthState();\n  }, []);\n\n  const checkAuthState = async () => {\n    try {\n      const token = await SecureStore.getItemAsync('access_token');\n      setIsAuthenticated(!!token);\n    } catch (error) {\n      console.error('Error checking auth state:', error);\n      setIsAuthenticated(false);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const signIn = async (token: string, refreshToken: string, userData: User) => {\n    try {\n      await SecureStore.setItemAsync('access_token', token);\n      if (refreshToken) {\n        await SecureStore.setItemAsync('refresh_token', refreshToken);\n      }\n      setUser(userData);\n      setIsAuthenticated(true);\n      // @ts-ignore\n      navigation.navigate('HomeFeed');\n    } catch (error) {\n      console.error('Error signing in:', error);\n      throw error;\n    }\n  };\n\n  const updateUser = (userData: Partial<User>) => {\n    if (user) {\n      setUser({ ...user, ...userData });\n    }\n  };\n\n  const signOut = async () => {\n    try {\n      await SecureStore.deleteItemAsync('access_token');\n      await SecureStore.deleteItemAsync('refresh_token');\n      setUser(null);\n      setIsAuthenticated(false);\n      // @ts-ignore\n      navigation.navigate('Welcome');\n    } catch (error) {\n      console.error('Error signing out:', error);\n      throw error;\n    }\n  };\n\n  return (\n    <AuthContext.Provider\n      value={{\n        isAuthenticated,\n        isLoading,\n        user,\n        signIn,\n        signOut,\n        updateUser,\n      }}>\n      {!isLoading && children}\n    </AuthContext.Provider>\n  );\n};\n\nexport const useAuth = () => {\n  const context = useContext(AuthContext);\n  if (!context) {\n    throw new Error('useAuth must be used within an AuthProvider');\n  }\n  return context;\n};\n"],"mappings":";AAAA,OAAOA,KAAK,IAAIC,aAAa,EAAEC,UAAU,EAAEC,SAAS,EAAEC,QAAQ,QAAQ,OAAO;AAC7E,OAAO,KAAKC,WAAW,MAAM,mBAAmB;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAsBjD,MAAMC,WAAW,GAAGP,aAAa,CAAkB,CAAC,CAAoB,CAAC;AAEzE,OAAO,MAAMQ,YAAqD,GAAGA,CAAC;EAAEC;AAAS,CAAC,KAAK;EACrF,MAAM,CAACC,eAAe,EAAEC,kBAAkB,CAAC,GAAGR,QAAQ,CAAC,KAAK,CAAC;EAC7D,MAAM,CAACS,SAAS,EAAEC,YAAY,CAAC,GAAGV,QAAQ,CAAC,IAAI,CAAC;EAChD,MAAM,CAACW,IAAI,EAAEC,OAAO,CAAC,GAAGZ,QAAQ,CAAc,IAAI,CAAC;EAEnDD,SAAS,CAAC,MAAM;IACdc,cAAc,CAAC,CAAC;EAClB,CAAC,EAAE,EAAE,CAAC;EAEN,MAAMA,cAAc,GAAG,MAAAA,CAAA,KAAY;IACjC,IAAI;MACF,MAAMC,KAAK,GAAG,MAAMb,WAAW,CAACc,YAAY,CAAC,cAAc,CAAC;MAC5DP,kBAAkB,CAAC,CAAC,CAACM,KAAK,CAAC;IAC7B,CAAC,CAAC,OAAOE,KAAK,EAAE;MACdC,OAAO,CAACD,KAAK,CAAC,4BAA4B,EAAEA,KAAK,CAAC;MAClDR,kBAAkB,CAAC,KAAK,CAAC;IAC3B,CAAC,SAAS;MACRE,YAAY,CAAC,KAAK,CAAC;IACrB;EACF,CAAC;EAED,MAAMQ,MAAM,GAAG,MAAAA,CAAOJ,KAAa,EAAEK,YAAoB,EAAEC,QAAc,KAAK;IAC5E,IAAI;MACF,MAAMnB,WAAW,CAACoB,YAAY,CAAC,cAAc,EAAEP,KAAK,CAAC;MACrD,IAAIK,YAAY,EAAE;QAChB,MAAMlB,WAAW,CAACoB,YAAY,CAAC,eAAe,EAAEF,YAAY,CAAC;MAC/D;MACAP,OAAO,CAACQ,QAAQ,CAAC;MACjBZ,kBAAkB,CAAC,IAAI,CAAC;MAExBc,UAAU,CAACC,QAAQ,CAAC,UAAU,CAAC;IACjC,CAAC,CAAC,OAAOP,KAAK,EAAE;MACdC,OAAO,CAACD,KAAK,CAAC,mBAAmB,EAAEA,KAAK,CAAC;MACzC,MAAMA,KAAK;IACb;EACF,CAAC;EAED,MAAMQ,UAAU,GAAIJ,QAAuB,IAAK;IAC9C,IAAIT,IAAI,EAAE;MACRC,OAAO,CAAAa,MAAA,CAAAC,MAAA,KAAMf,IAAI,EAAKS,QAAQ,CAAE,CAAC;IACnC;EACF,CAAC;EAED,MAAMO,OAAO,GAAG,MAAAA,CAAA,KAAY;IAC1B,IAAI;MACF,MAAM1B,WAAW,CAAC2B,eAAe,CAAC,cAAc,CAAC;MACjD,MAAM3B,WAAW,CAAC2B,eAAe,CAAC,eAAe,CAAC;MAClDhB,OAAO,CAAC,IAAI,CAAC;MACbJ,kBAAkB,CAAC,KAAK,CAAC;MAEzBc,UAAU,CAACC,QAAQ,CAAC,SAAS,CAAC;IAChC,CAAC,CAAC,OAAOP,KAAK,EAAE;MACdC,OAAO,CAACD,KAAK,CAAC,oBAAoB,EAAEA,KAAK,CAAC;MAC1C,MAAMA,KAAK;IACb;EACF,CAAC;EAED,OACEb,OAAA,CAACC,WAAW,CAACyB,QAAQ;IACnBC,KAAK,EAAE;MACLvB,eAAe;MACfE,SAAS;MACTE,IAAI;MACJO,MAAM;MACNS,OAAO;MACPH;IACF,CAAE;IAAAlB,QAAA,EACD,CAACG,SAAS,IAAIH;EAAQ;IAAAyB,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACH,CAAC;AAE3B,CAAC;AAED,OAAO,MAAMC,OAAO,GAAGA,CAAA,KAAM;EAC3B,MAAMC,OAAO,GAAGtC,UAAU,CAACM,WAAW,CAAC;EACvC,IAAI,CAACgC,OAAO,EAAE;IACZ,MAAM,IAAIC,KAAK,CAAC,6CAA6C,CAAC;EAChE;EACA,OAAOD,OAAO;AAChB,CAAC","ignoreList":[]},"metadata":{"hasCjsExports":false},"sourceType":"module","externalDependencies":[]}